# Architecture Decision Records (ADR)

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é‡è¦ãªæŠ€è¡“çš„æ±ºå®šã‚’è¨˜éŒ²ã—ãŸ ADR ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ADR ã®ä¾¡å€¤

### ãªãœ ADR ãŒé‡è¦ã‹ï¼Ÿ

1. **æ„æ€æ±ºå®šã®é€æ˜æ€§**: ãªãœãã®æŠ€è¡“ãƒ»æ–¹é‡ã‚’é¸ã‚“ã ã‹ã®æ ¹æ‹ ã‚’æ˜ç¢ºã«ã™ã‚‹
2. **æ­´å²ã®è¨˜éŒ²**: éå»ã®åˆ¤æ–­ã‚’æŒ¯ã‚Šè¿”ã‚Œã‚‹
3. **ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°**: æ–°ãƒ¡ãƒ³ãƒãƒ¼ãŒè¨­è¨ˆæ€æƒ³ã‚’ç†è§£ã—ã‚„ã™ã„
4. **è­°è«–ã®åœŸå°**: å¤‰æ›´ææ¡ˆæ™‚ã«éå»ã®åˆ¤æ–­ã‚’å‚ç…§ã§ãã‚‹

### ADR ã®é™ç•Œ

- **å®Ÿè£…ã®è©³ç´°**: ã‚³ãƒ¼ãƒ‰ã‚³ãƒ¡ãƒ³ãƒˆã‚„ docstring ã«è¨˜è¼‰
- **é‹ç”¨æ‰‹é †**: CLAUDE.md ã«è¨˜è¼‰
- **ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜**: domain/ã«è¨˜è¼‰

---

## ADR ä¸€è¦§

### 0001: Clean Architecture ã®æ¡ç”¨

**Status**: âœ… Accepted (2024-11-23)

**æ±ºå®šå†…å®¹**: 3 å±¤ Clean Architectureï¼ˆDomain/Application/Presentationï¼‰ã‚’æ¡ç”¨

**ç†ç”±**:

- ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§å‘ä¸Š
- å¤‰æ›´ã¸ã®å¼·ã•
- è²¬ä»»ã®æ˜ç¢ºåŒ–

è©³ç´°: [0001-adopt-clean-architecture.md](./0001-adopt-clean-architecture.md)

### 0002: Immer.js ã«ã‚ˆã‚‹ä¸å¤‰æ€§ä¿è¨¼

**Status**: âœ… Accepted (2024-11-23)

**æ±ºå®šå†…å®¹**: Immer.js ã‚’ä½¿ç”¨ã—ã¦ GameState ã®ä¸å¤‰æ€§ã‚’ä¿è¨¼

**ç†ç”±**:

- ç›´æ„Ÿçš„ãªæ›¸ãæ–¹ã§ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªçµæœ
- Structural Sharing ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- TypeScript `readonly`ã¨ã®ä½µç”¨ã§å‹å®‰å…¨æ€§

è©³ç´°: [0002-use-immer-for-immutability.md](./0002-use-immer-for-immutability.md)

### 0003: Effect System å»ƒæ­¢

**Status**: âœ… Accepted (2024-11-24)

**æ±ºå®šå†…å®¹**: Phase 4 ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã€Effect System ã‚’ Command Pattern ã«çµ±ä¸€

**ç†ç”±**:

- Command Pattern ã§ååˆ†ãªæ©Ÿèƒ½ã‚«ãƒãƒ¼
- 3,839 è¡Œã®ã‚³ãƒ¼ãƒ‰å‰Šæ¸›
- è¨­è¨ˆã®ã‚·ãƒ³ãƒ—ãƒ«åŒ–

**å½±éŸ¿**: æ—§ DuelState + Effect Systemï¼ˆ24 ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’å®Œå…¨å‰Šé™¤

è©³ç´°: [0003-abolish-effect-system.md](./0003-abolish-effect-system.md)

### 0004: ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†é›¢

**Status**: âœ… Accepted (2024-11-29)

**æ±ºå®šå†…å®¹**: 3 å±¤ã®ã‚«ãƒ¼ãƒ‰å‹å®šç¾©ï¼ˆDomainCardData / CardDisplayData / YGOProDeckCardï¼‰

**ç†ç”±**:

- ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã®è²¬å‹™åˆ†é›¢
- ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§å‘ä¸Šï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸è¦ï¼‰
- æ•°å€¤ ID ã¸ã®çµ±ä¸€ï¼ˆæ–‡å­—åˆ— ID æ’é™¤ï¼‰

**å½±éŸ¿**: API çµ±åˆã¨ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥ã€æ®µéšçš„ç§»è¡Œãƒ‘ã‚¹

è©³ç´°: [0004-data-model-layer-separation.md](./0004-data-model-layer-separation.md)

### 0005: Card Effect Architecture ã« Strategy Pattern æ¡ç”¨

**Status**: âœ… Accepted (2024-12-07)

**æ±ºå®šå†…å®¹**: Strategy Pattern ã¨ Registry Pattern ã§ã‚«ãƒ¼ãƒ‰åŠ¹æœã‚’å®Ÿè£…

**ç†ç”±**:

- Open/Closed Principle éµå®ˆ
- ã‚«ãƒ¼ãƒ‰è¿½åŠ æ™‚ã« ActivateSpellCommand ã®å¤‰æ›´ä¸è¦
- ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ã¨ã‚³ãƒ¼ãƒ‰ã®å†åˆ©ç”¨æ€§å‘ä¸Š

**å½±éŸ¿**: CardEffect éšå±¤æ§‹é€ ã€CardEffectRegistry å°å…¥

è©³ç´°: [0005-card-effect-strategy-pattern.md](./0005-card-effect-strategy-pattern.md)

### 0006: 4 å±¤ Clean Architecture ã¸ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

**Status**: âœ… Accepted (2024-12-15)

**æ±ºå®šå†…å®¹**: 3 å±¤æ§‹é€ ã‚’ 4 å±¤æ§‹é€ ï¼ˆDomain/Application/Infrastructure/Presentationï¼‰ã«å†ç·¨

**ç†ç”±**:

- Infrastructure Layer ã®æ˜ç¢ºåŒ–ï¼ˆPort/Adapter ãƒ‘ã‚¿ãƒ¼ãƒ³å°å…¥ï¼‰
- Stores é…ç½®ã®çµ±ä¸€ï¼ˆè²¬ä»»ã«å¿œã˜ãŸé…ç½®åŸºæº–ç¢ºç«‹ï¼‰
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ä¾å­˜é–¢ä¿‚ã®æ˜¯æ­£ï¼ˆå‹å®šç¾©ã®é©åˆ‡ãªé…ç½®ï¼‰
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã‚³ãƒ¼ãƒ‰ã®ä¸€è‡´

**å½±éŸ¿**: å¤§è¦æ¨¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•ã€å…¨ 312 ãƒ†ã‚¹ãƒˆå¼•ãç¶šã passã€E2E ãƒ†ã‚¹ãƒˆ 1 ä»¶ã«çµã‚Šè¾¼ã¿

è©³ç´°: [0006-four-layer-clean-architecture.md](./0006-four-layer-clean-architecture.md)

---

## ADR ã®æ›¸ãæ–¹

### ADR ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
# ADR-000X: ã‚¿ã‚¤ãƒˆãƒ«

## Status

âœ… Accepted / âŒ Rejected / â¸ï¸ Superseded / ğŸ¤” Proposed

## Context

ä½•ãŒå•é¡Œã ã£ãŸã‹ï¼Ÿãªãœã“ã®æ±ºå®šãŒå¿…è¦ã ã£ãŸã‹ï¼Ÿ

## Decision

ä½•ã‚’æ±ºå®šã—ãŸã‹ï¼Ÿå…·ä½“çš„ãªå®Ÿè£…æ–¹é‡ã¯ï¼Ÿ

## Consequences

### Positive

âœ… ãƒ¡ãƒªãƒƒãƒˆ 1
âœ… ãƒ¡ãƒªãƒƒãƒˆ 2

### Negative

âŒ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ 1
âŒ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ 2

### Neutral

âš–ï¸ ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•

## Alternatives Considered

æ¤œè¨ã—ãŸä»£æ›¿æ¡ˆã¨ãã®å´ä¸‹ç†ç”±

## Implementation Notes

å®Ÿè£…æ™‚ã®æ³¨æ„ç‚¹ã‚„ã‚³ãƒ¼ãƒ‰ä¾‹

## Related Documents

é–¢é€£ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®ãƒªãƒ³ã‚¯

## References

- é–¢é€£ PR/Issue
- å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹
```

### å‘½åè¦å‰‡

```
0001-adopt-clean-architecture.md
0002-use-immer-for-immutability.md
0003-abolish-effect-system.md
^^^^
4æ¡ã®é€£ç•ª
```

### ã„ã¤ ADR ã‚’æ›¸ãã‹ï¼Ÿ

ä»¥ä¸‹ã®å ´åˆã« ADR ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š

âœ… **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å¤§ããªå¤‰æ›´**

- ä¾‹: Clean Architecture å°å…¥ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆå¤‰æ›´

âœ… **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®š**

- ä¾‹: Immer.js æ¡ç”¨ã€ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯é¸å®š

âœ… **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¡ç”¨/å»ƒæ­¢**

- ä¾‹: Effect System å»ƒæ­¢ã€Command Pattern çµ±ä¸€

âœ… **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ–¹é‡**

- ä¾‹: ä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å°å…¥ã€ãƒ¡ãƒ¢åŒ–æˆ¦ç•¥

âŒ **è»½å¾®ãªå®Ÿè£…ã®è©³ç´°**

- ä¾‹: å¤‰æ•°åå¤‰æ›´ã€é–¢æ•°ã®åˆ†å‰²

âŒ **ãƒã‚°ä¿®æ­£**

- ä¾‹: å‹ã‚¨ãƒ©ãƒ¼ä¿®æ­£ã€ãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£ï¼ˆADR ã§ã¯ãªãã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«è¨˜è¼‰ï¼‰

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®æ„å‘³

| Status            | èª¬æ˜                      | ä½¿ç”¨ä¾‹                        |
| ----------------- | ------------------------- | ----------------------------- |
| ğŸ¤” **Proposed**   | ææ¡ˆä¸­ï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡ï¼‰    | PR ä½œæˆå‰ã®è­°è«–æ®µéš           |
| âœ… **Accepted**   | æ‰¿èªæ¸ˆã¿ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰      | ãƒãƒ¼ã‚¸å¾Œ                      |
| âŒ **Rejected**   | å´ä¸‹ã•ã‚ŒãŸ                | ä»£æ›¿æ¡ˆãŒæ¡ç”¨ã•ã‚ŒãŸå ´åˆ        |
| â¸ï¸ **Superseded** | åˆ¥ã® ADR ã«ç½®ãæ›ãˆã‚‰ã‚ŒãŸ | ADR-0005 ãŒ ADR-0002 ã‚’ä¸Šæ›¸ã |

### æ—¢å­˜ ADR ã®æ›´æ–°

#### çŠ¶æ³ãŒå¤‰ã‚ã£ãŸå ´åˆ

æ—¢å­˜ ADR ã¯**ç·¨é›†ã›ãš**ã€æ–°ã—ã„ ADR ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š

```markdown
# ADR-0005: Immer.js å»ƒæ­¢ã¨ Immutable.js æ¡ç”¨

## Status

âœ… Accepted

## Context

ADR-0002 ã§ Immer.js ã‚’æ¡ç”¨ã—ãŸãŒã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡ŒãŒç™ºç”Ÿ...

## Related Documents

- Supersedes: [ADR-0002](./0002-use-immer-for-immutability.md)
```

æ—§ ADR ã«ã¯ä»¥ä¸‹ã‚’è¿½è¨˜ï¼š

```markdown
# ADR-0002: Immer.js ã«ã‚ˆã‚‹ä¸å¤‰æ€§ä¿è¨¼

## Status

â¸ï¸ Superseded by [ADR-0005](./0005-adopt-immutable-js.md)
```

---

## é–¢é€£ãƒªã‚½ãƒ¼ã‚¹

- [è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª](../) - docs/å…¨ä½“ã®ç›®æ¬¡
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦](../architecture/overview.md) - ç¾åœ¨ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- [ADR ã®æå”±è€…](https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions) - Michael Nygard ã®åŸæ–‡
